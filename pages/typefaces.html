<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Typefaces - The Loveprinting Machine Type Foundry</title>
    
    <!-- Подключение модульных CSS файлов -->
    <link rel="stylesheet" href="../css/variables.css">
    <link rel="stylesheet" href="../css/reset.css">
    <link rel="stylesheet" href="../css/typography.css">
    <link rel="stylesheet" href="../css/layout.css">
    <link rel="stylesheet" href="../css/components.css">
    <link rel="stylesheet" href="../css/responsive.css">
    
    <!-- Preload критичных ресурсов -->
    <link rel="preload" href="../fonts/retry-sans-mono.woff2" as="font" type="font/woff2" crossorigin>
</head>
<body data-page="typefaces">
    <!-- Header -->
    <header class="header">
        <div class="container">
            <nav class="nav">
                <a href="../index.html" class="logo">
                    <img src="../assets/svg/logo.svg" alt="The Loveprinting Machine">
                </a>
                <ul class="nav__list">
                    <li><a href="typefaces.html" class="nav__link--active">Typefaces</a></li>
                    <li><a href="fonts-in-use.html">Fonts in use</a></li>
                    <li><a href="lettering.html">Lettering</a></li>
                    <li><a href="about.html">About</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <!-- Page Hero -->
    <section class="page-hero">
        <div class="container">
            <h1 class="page-hero__title">Our Typefaces</h1>
            <p class="page-hero__description">
                Discover our collection of carefully crafted typefaces, each designed with attention to detail and modern typography standards.
            </p>
        </div>
    </section>

    <!-- Scroll Animation -->
    <section class="scroll-animation" data-animation="scroll-trigger">
        <div class="container">
            <div class="animation-container">
                <img src="../assets/gif/typefaces-animation.gif" alt="Typefaces Animation" class="scroll-gif">
            </div>
        </div>
    </section>

    <!-- Filters Section -->
    <section class="filters">
        <div class="container">
            <div class="filters__header">
                <h2 class="filters__title">Filter Typefaces</h2>
                <div class="filters__results">
                    <span data-results-count>Loading...</span>
                </div>
            </div>
            
            <div class="filters__controls">
                <!-- Поиск -->
                <div class="filter-group">
                    <label for="search" class="filter-label">Search:</label>
                    <input 
                        type="text" 
                        id="search" 
                        data-filter="search" 
                        placeholder="Search typefaces..." 
                        class="filter-input"
                    >
                </div>

                <!-- Фильтр по типу -->
                <div class="filter-group">
                    <label for="type-filter" class="filter-label">Type:</label>
                    <select id="type-filter" data-filter-type="type" class="filter-select">
                        <option value="">All Types</option>
                        <option value="variable">Variable</option>
                        <option value="static">Static</option>
                    </select>
                </div>

                <!-- Фильтр по количеству стилей -->
                <div class="filter-group">
                    <label for="styles-filter" class="filter-label">Styles:</label>
                    <select id="styles-filter" data-filter-type="styles" class="filter-select">
                        <option value="">All Styles</option>
                        <option value="1-5">1-5 styles</option>
                        <option value="6-10">6-10 styles</option>
                        <option value="11+">11+ styles</option>
                    </select>
                </div>

                <!-- Фильтр по доступности -->
                <div class="filter-group">
                    <label for="availability-filter" class="filter-label">Availability:</label>
                    <div class="checkbox-group">
                        <label class="checkbox-label">
                            <input type="checkbox" data-filter-type="external" value="false">
                            <span class="checkbox-text">Available Here</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" data-filter-type="external" value="true">
                            <span class="checkbox-text">External Platforms</span>
                        </label>
                    </div>
                </div>

                <!-- Фильтр по ценовому диапазону -->
                <div class="filter-group">
                    <label for="price-filter" class="filter-label">Price:</label>
                    <select id="price-filter" data-filter-type="price" class="filter-select">
                        <option value="">All Prices</option>
                        <option value="0-50">$0-50</option>
                        <option value="51-100">$51-100</option>
                        <option value="101+">$101+</option>
                    </select>
                </div>

                <!-- Фильтр по функциям -->
                <div class="filter-group">
                    <label class="filter-label">Features:</label>
                    <div class="checkbox-group">
                        <label class="checkbox-label">
                            <input type="checkbox" data-filter-type="features" value="OpenType features">
                            <span class="checkbox-text">OpenType Features</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" data-filter-type="features" value="Extended Latin character set">
                            <span class="checkbox-text">Extended Latin</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" data-filter-type="features" value="Stylistic alternates">
                            <span class="checkbox-text">Stylistic Alternates</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" data-filter-type="features" value="Variable axes">
                            <span class="checkbox-text">Variable Axes</span>
                        </label>
                    </div>
                </div>

                <!-- Сортировка -->
                <div class="filter-group">
                    <label for="sort-select" class="filter-label">Sort by:</label>
                    <select id="sort-select" data-sort class="filter-select">
                        <option value="name:asc">Name A-Z</option>
                        <option value="name:desc">Name Z-A</option>
                        <option value="price:asc">Price: Low to High</option>
                        <option value="price:desc">Price: High to Low</option>
                        <option value="styles:desc">Most Styles</option>
                        <option value="styles:asc">Fewest Styles</option>
                    </select>
                </div>

                <!-- Кнопки сортировки -->
                <div class="filter-group">
                    <div class="sort-buttons">
                        <button data-sort-by="name" class="sort-btn">Name</button>
                        <button data-sort-by="price" class="sort-btn">Price</button>
                        <button data-sort-by="styles" class="sort-btn">Styles</button>
                    </div>
                </div>

                <!-- Кнопка сброса -->
                <div class="filter-group">
                    <button data-filter-reset class="btn btn--secondary">Reset Filters</button>
                </div>
            </div>
        </div>
    </section>

    <!-- Typefaces Grid -->
    <section class="typefaces" data-animation="staggered">
        <div class="container">
            <div class="typefaces-grid" id="typefaces-grid">
                <!-- Контент будет загружен динамически из typefaces.json -->
                <div class="loading-placeholder">
                    <p>Loading typefaces...</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Newsletter Signup -->
    <section class="newsletter">
        <div class="container">
            <div class="newsletter__content">
                <h2>Stay Updated</h2>
                <p>Get notified about new typeface releases and exclusive offers.</p>
                <form class="newsletter__form">
                    <input type="email" placeholder="Enter your email" class="newsletter__input" required>
                    <button type="submit" class="btn btn--primary">Subscribe</button>
                </form>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer__content">
                <div class="footer__logo">
                    <img src="../assets/svg/logo.svg" alt="The Loveprinting Machine">
                </div>
                <nav class="footer__nav">
                    <ul>
                        <li><a href="typefaces.html">Typefaces</a></li>
                        <li><a href="fonts-in-use.html">Fonts in use</a></li>
                        <li><a href="lettering.html">Lettering</a></li>
                        <li><a href="about.html">About</a></li>
                    </ul>
                </nav>
                <div class="footer__contacts">
                    <p>info@loveprinting.com</p>
                    <div class="social-links">
                        <a href="#" class="social-link">Instagram</a>
                        <a href="#" class="social-link">Behance</a>
                    </div>
                </div>
            </div>
            <div class="footer__bottom">
                <p>&copy; 2025 The Loveprinting Machine Type Foundry. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <!-- Подключение модульных JavaScript файлов -->
    <script src="../js/data-loader.js"></script>
    <script src="../js/filters.js"></script>
    <script src="../js/animations.js"></script>
    <script src="../js/main.js"></script>
    
    <!-- Инициализация страницы шрифтов -->
    <script>
        // Минимальная инициализация - вся логика в модулях
        document.addEventListener('DOMContentLoaded', async () => {
            try {
                // Загрузка данных о шрифтах
                const typefacesData = await window.DataLoader.loadTypefaces();
                
                // Настройка фильтра (уже инициализирован в filters.js)
                if (window.typefaceFilter && typefacesData) {
                    window.typefaceFilter.setData(typefacesData.fonts);
                }
                
                // Импорт фильтров из URL
                if (window.typefaceFilter) {
                    window.typefaceFilter.importFromURL();
                }
                
                // Обработчик формы подписки
                const newsletterForm = document.querySelector('.newsletter__form');
                if (newsletterForm) {
                    newsletterForm.addEventListener('submit', (e) => {
                        e.preventDefault();
                        const email = e.target.querySelector('input[type="email"]').value;
                        
                        // Здесь будет логика отправки email
                        console.log('Newsletter signup:', email);
                        
                        // Показать сообщение об успехе
                        const button = e.target.querySelector('button');
                        const originalText = button.textContent;
                        button.textContent = 'Subscribed!';
                        button.disabled = true;
                        
                        setTimeout(() => {
                            button.textContent = originalText;
                            button.disabled = false;
                            e.target.reset();
                        }, 2000);
                    });
                }
                
            } catch (error) {
                console.error('Error loading typefaces data:', error);
                document.getElementById('typefaces-grid').innerHTML = 
                    '<p class="error-message">Error loading typefaces. Please try again later.</p>';
            }
        });
        
        // Функция рендеринга шрифтов (вызывается из filters.js)
        window.renderTypefaces = (typefaces) => {
            const grid = document.getElementById('typefaces-grid');
            
            if (!typefaces || typefaces.length === 0) {
                grid.innerHTML = '<p class="no-results">No typefaces found matching your criteria.</p>';
                return;
            }
            
            grid.innerHTML = typefaces.map(font => `
                <article class="typeface-card stagger-item">
                    <div class="typeface-card__preview">
                        <a href="../typeface/${font.id}.html">
                            <img src="../assets/svg/${font.previewSVG}" alt="${font.nameDisplay} Preview" loading="lazy">
                        </a>
                        ${font.type === 'variable' ? '<span class="typeface-card__badge">Variable</span>' : ''}
                        ${font.isExternal ? '<span class="typeface-card__external">External</span>' : ''}
                    </div>
                    <div class="typeface-card__content">
                        <h3 class="typeface-card__title">
                            <a href="../typeface/${font.id}.html">${font.nameDisplay}</a>
                        </h3>
                        <p class="typeface-card__description">${font.description}</p>
                        <div class="typeface-card__meta">
                            <span class="typeface-card__styles">${font.styles} style${font.styles !== 1 ? 's' : ''}</span>
                            <span class="typeface-card__price">${font.price}</span>
                        </div>
                        <div class="typeface-card__features">
                            ${font.features.slice(0, 2).map(feature => 
                                `<span class="feature-tag">${feature}</span>`
                            ).join('')}
                        </div>
                        <div class="typeface-card__actions">
                            ${font.isExternal ? 
                                `<a href="${font.purchaseUrl}" class="btn btn--primary btn--small" target="_blank" rel="noopener">View on ${font.externalPlatform}</a>` :
                                `<a href="../typeface/${font.id}.html" class="btn btn--primary btn--small">Try & Buy</a>`
                            }
                            <a href="../typeface/${font.id}.html" class="btn btn--secondary btn--small">Details</a>
                        </div>
                    </div>
                </article>
            `).join('');
        };
    </script>
</body>
</html>