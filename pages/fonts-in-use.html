<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fonts in Use - The Loveprinting Machine Type Foundry</title>
    
    <!-- Подключение модульных CSS файлов -->
    <link rel="stylesheet" href="../css/variables.css">
    <link rel="stylesheet" href="../css/reset.css">
    <link rel="stylesheet" href="../css/typography.css">
    <link rel="stylesheet" href="../css/layout.css">
    <link rel="stylesheet" href="../css/components.css">
    <link rel="stylesheet" href="../css/responsive.css">
    
    <!-- Preload критичных ресурсов -->
    <link rel="preload" href="../fonts/retry-sans-mono.woff2" as="font" type="font/woff2" crossorigin>
</head>
<body data-page="fonts-in-use">
    <!-- Header -->
    <header class="header">
        <div class="container">
            <nav class="nav">
                <a href="../index.html" class="logo">
                    <img src="../assets/svg/logo.svg" alt="The Loveprinting Machine">
                </a>
                <ul class="nav__list">
                    <li><a href="typefaces.html">Typefaces</a></li>
                    <li><a href="fonts-in-use.html" class="nav__link--active">Fonts in use</a></li>
                    <li><a href="lettering.html">Lettering</a></li>
                    <li><a href="about.html">About</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <!-- Page Hero -->
    <section class="page-hero">
        <div class="container">
            <h1 class="page-hero__title">Fonts in Use</h1>
            <p class="page-hero__description">
                Discover how our typefaces are being used in real projects by designers and brands around the world.
            </p>
        </div>
    </section>

    <!-- Scroll Animation -->
    <section class="scroll-animation" data-animation="scroll-trigger">
        <div class="container">
            <div class="animation-container">
                <img src="../assets/gif/projects-animation.gif" alt="Projects Animation" class="scroll-gif">
            </div>
        </div>
    </section>

    <!-- Filters Section -->
    <section class="filters">
        <div class="container">
            <div class="filters__header">
                <h2 class="filters__title">Filter Projects</h2>
                <div class="filters__results">
                    <span data-results-count>Loading...</span>
                </div>
            </div>
            
            <div class="filters__controls">
                <!-- Поиск -->
                <div class="filter-group">
                    <label for="search" class="filter-label">Search:</label>
                    <input 
                        type="text" 
                        id="search" 
                        data-filter="search" 
                        placeholder="Search projects..." 
                        class="filter-input"
                    >
                </div>

                <!-- Фильтр по шрифтам -->
                <div class="filter-group">
                    <label for="font-filter" class="filter-label">Font:</label>
                    <select id="font-filter" data-filter-type="fonts" class="filter-select">
                        <option value="">All Fonts</option>
                        <!-- Опции будут загружены динамически -->
                    </select>
                </div>

                <!-- Фильтр по категориям -->
                <div class="filter-group">
                    <label for="category-filter" class="filter-label">Category:</label>
                    <select id="category-filter" data-filter-type="category" class="filter-select">
                        <option value="">All Categories</option>
                        <option value="branding">Branding</option>
                        <option value="editorial">Editorial</option>
                        <option value="web">Web Design</option>
                        <option value="packaging">Packaging</option>
                        <option value="poster">Poster</option>
                        <option value="book">Book Design</option>
                    </select>
                </div>

                <!-- Фильтр по типу проекта -->
                <div class="filter-group">
                    <label for="type-filter" class="filter-label">Type:</label>
                    <div class="checkbox-group">
                        <label class="checkbox-label">
                            <input type="checkbox" data-filter-type="type" value="commercial">
                            <span class="checkbox-text">Commercial</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" data-filter-type="type" value="personal">
                            <span class="checkbox-text">Personal</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" data-filter-type="type" value="experimental">
                            <span class="checkbox-text">Experimental</span>
                        </label>
                    </div>
                </div>

                <!-- Сортировка -->
                <div class="filter-group">
                    <label for="sort-select" class="filter-label">Sort by:</label>
                    <select id="sort-select" data-sort class="filter-select">
                        <option value="date:desc">Newest First</option>
                        <option value="date:asc">Oldest First</option>
                        <option value="name:asc">Name A-Z</option>
                        <option value="name:desc">Name Z-A</option>
                        <option value="client:asc">Client A-Z</option>
                    </select>
                </div>

                <!-- Кнопка сброса -->
                <div class="filter-group">
                    <button data-filter-reset class="btn btn--secondary">Reset Filters</button>
                </div>
            </div>
        </div>
    </section>

    <!-- Projects Grid -->
    <section class="projects" data-animation="staggered">
        <div class="container">
            <div class="projects-grid" id="projects-grid">
                <!-- Контент будет загружен динамически из projects.json -->
                <div class="loading-placeholder">
                    <p>Loading projects...</p>
                </div>
            </div>
        </div>
    </section>

    <!-- CTA Section -->
    <section class="cta">
        <div class="container">
            <div class="cta__content">
                <h2>Want to showcase your project?</h2>
                <p>We'd love to feature your work using our typefaces. Get in touch and let us know about your project.</p>
                <a href="mailto:info@loveprinting.com" class="btn btn--primary">Submit Your Project</a>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer__content">
                <div class="footer__logo">
                    <img src="../assets/svg/logo.svg" alt="The Loveprinting Machine">
                </div>
                <nav class="footer__nav">
                    <ul>
                        <li><a href="typefaces.html">Typefaces</a></li>
                        <li><a href="fonts-in-use.html">Fonts in use</a></li>
                        <li><a href="lettering.html">Lettering</a></li>
                        <li><a href="about.html">About</a></li>
                    </ul>
                </nav>
                <div class="footer__contacts">
                    <p>info@loveprinting.com</p>
                    <div class="social-links">
                        <a href="#" class="social-link">Instagram</a>
                        <a href="#" class="social-link">Behance</a>
                    </div>
                </div>
            </div>
            <div class="footer__bottom">
                <p>&copy; 2025 The Loveprinting Machine Type Foundry. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <!-- Подключение модульных JavaScript файлов -->
    <script src="../js/data-loader.js"></script>
    <script src="../js/filters.js"></script>
    <script src="../js/animations.js"></script>
    <script src="../js/main.js"></script>
    
    <!-- Инициализация страницы проектов -->
    <script>
        // Минимальная инициализация - вся логика в модулях
        document.addEventListener('DOMContentLoaded', async () => {
            try {
                // Загрузка данных о проектах
                const projectsData = await window.DataLoader.loadProjects();
                
                // Настройка фильтра (уже инициализирован в filters.js)
                if (window.projectFilter && projectsData) {
                    window.projectFilter.setData(projectsData.projects);
                }
                
                // Загрузка опций для фильтра по шрифтам
                const typefacesData = await window.DataLoader.loadTypefaces();
                if (typefacesData) {
                    const fontSelect = document.getElementById('font-filter');
                    typefacesData.fonts.forEach(font => {
                        const option = document.createElement('option');
                        option.value = font.id;
                        option.textContent = font.nameDisplay;
                        fontSelect.appendChild(option);
                    });
                }
                
                // Импорт фильтров из URL
                if (window.projectFilter) {
                    window.projectFilter.importFromURL();
                }
                
            } catch (error) {
                console.error('Error loading projects data:', error);
                document.getElementById('projects-grid').innerHTML = 
                    '<p class="error-message">Error loading projects. Please try again later.</p>';
            }
        });
        
        // Функция рендеринга проектов (вызывается из filters.js)
        window.renderProjects = (projects) => {
            const grid = document.getElementById('projects-grid');
            
            if (!projects || projects.length === 0) {
                grid.innerHTML = '<p class="no-results">No projects found matching your criteria.</p>';
                return;
            }
            
            grid.innerHTML = projects.map(project => `
                <article class="project-card stagger-item">
                    <div class="project-card__image">
                        <img src="../${project.image}" alt="${project.title}" loading="lazy">
                        ${project.featured ? '<span class="project-card__featured">Featured</span>' : ''}
                    </div>
                    <div class="project-card__content">
                        <h3 class="project-card__title">${project.title}</h3>
                        <p class="project-card__client">${project.client}</p>
                        <p class="project-card__description">${project.description}</p>
                        <div class="project-card__meta">
                            <span class="project-card__category">${project.category}</span>
                            <span class="project-card__fonts">
                                ${project.fonts.map(fontId => {
                                    const font = window.typefacesData?.fonts.find(f => f.id === fontId);
                                    return font ? font.nameDisplay : fontId;
                                }).join(', ')}
                            </span>
                        </div>
                        ${project.url ? `<a href="${project.url}" class="project-card__link" target="_blank" rel="noopener">View Project</a>` : ''}
                    </div>
                </article>
            `).join('');
        };
    </script>
</body>
</html>